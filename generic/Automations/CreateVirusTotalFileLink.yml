commonfields:
  id: 3ee4ea09-7603-4160-8fe8-db800855a91d
  version: 3
name: CreateVirusTotalFileLink
script: |-
  inputData = demisto.args()["vtID"]
  fileIDs = []
  links = []
  if type(inputData) == list:
      for x in inputData:
          fileIDs.append(x)
  else:
      fileIDs.append(inputData)

  for a in fileIDs:
      if "-" in a:
          b = a.split("-")[0]
          links.append("https://www.virustotal.com/gui/file/{0}/detection".format(b))
      else:
          links.append("https://www.virustotal.com/gui/file/{0}/detection".format(a))

  demisto.setContext("virusTotalFileSubmissionLinks", links)
type: python
tags: []
enabled: true
args:
- name: vtID
  required: true
  description: ID provided for the file submission reference
outputs:
- contextPath: virusTotalFileSubmissionLinks
  description: Links generated
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.7.4.977
runas: DBotWeakRole
